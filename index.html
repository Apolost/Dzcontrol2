<!DOCTYPE html>
<html lang="cs" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DZ Control</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="index.css">
</head>
<body>

    <nav id="app-nav">
        <div>
            <div class="nav-header">DZ Control <span id="digital-clock"></span></div>
            <div class="nav-links">
                <a href="#" class="nav-link active" data-view="main-page"><i data-feather="home"></i><span>Hlavní stránka</span></a>
                <details>
                    <summary><i data-feather="clipboard"></i><span>Výroba</span><i data-feather="chevron-right" class="arrow-icon"></i></summary>
                    <div class="submenu">
                        <a href="#" class="nav-link" data-view="daily-plan"><span>Denní Plán</span></a>
                        <a href="#" class="nav-link" data-view="orders"><span>Objednávky</span></a>
                        <a href="#" class="nav-link" data-view="calendar"><span>Kalendář akcí</span></a>
                        <a href="#" class="nav-link" data-view="kfc"><span>KFC</span></a>
                        <a href="#" class="nav-link" data-view="calculator"><span>Kalkulačka suroviny</span></a>
                    </div>
                </details>
                <a href="#" class="nav-link" data-view="zmeny"><i data-feather="alert-triangle"></i><span>Změny</span></a>
                <details>
                    <summary><i data-feather="settings"></i><span>Nastavení</span><i data-feather="chevron-right" class="arrow-icon"></i></summary>
                    <div class="submenu">
                        <a href="#" class="nav-link" data-view="customers"><span>Zákazníci</span></a>
                        <a href="#" class="nav-link" data-view="create-product"><span>Vytvořit produkt</span></a>
                        <a href="#" class="nav-link" data-view="create-mix"><span>Vytvořit mix</span></a>
                        <a href="#" class="nav-link" data-view="box-weights"><span>Váhy beden</span></a>
                        <a href="#" class="nav-link" data-view="palette-weights"><span>Váhy palet</span></a>
                        <a href="#" class="nav-link" data-view="spizy-settings"><span>Nastavení špízů</span></a>
                        <a href="#" class="nav-link" data-view="kfc-products"><span>KFC Produkty</span></a>
                    </div>
                </details>
            </div>
        </div>
        <div class="nav-footer">
            <div id="autosave-indicator"></div>
            <div class="form-group" style="display: flex; gap: 10px;">
                 <button class="btn btn-secondary" style="flex: 1;" data-action="save-data-to-file" title="Uložit data do souboru"><i data-feather="download"></i></button>
                 <button class="btn btn-secondary" style="flex: 1;" data-action="load-data-from-file" title="Načíst data ze souboru"><i data-feather="upload"></i></button>
            </div>
            <div class="form-group">
                <label for="selectedDate">Datum plánu</label>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <button class="btn btn-secondary" data-action="prev-day" title="Předchozí den"><i data-feather="chevron-left"></i></button>
                    <input type="date" id="selectedDate" style="flex: 1;">
                    <button class="btn btn-secondary" data-action="next-day" title="Následující den"><i data-feather="chevron-right"></i></button>
                </div>
            </div>
        </div>
    </nav>

    <main id="app-main">
        <!-- Content is dynamically rendered by script -->
    </main>
  
    <!-- Modals -->
     <div id="rizky-add-order-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Přidat objednávku řízků na <span id="rizky-add-order-date"></span></h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body" id="rizky-add-order-modal-body">
                <!-- JS generated content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" data-action="save-rizky-orders">Uložit objednávky</button>
            </div>
        </div>
    </div>

    <div id="spizy-ingredient-order-modal" class="modal">
         <div class="modal-content" style="max-width: 500px;">
             <div class="modal-header">
                <h2 class="modal-title" id="spizy-ingredient-order-modal-title">Objednat surovinu</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                 <div class="form-group">
                    <label for="spizy-ingredient-order-date">Datum doručení</label>
                    <input type="date" id="spizy-ingredient-order-date">
                </div>
                 <div class="form-group">
                    <label for="spizy-ingredient-order-klobasa">Klobása (kg)</label>
                    <input type="number" id="spizy-ingredient-order-klobasa" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-ingredient-order-spek">Špek (kg)</label>
                    <input type="number" id="spizy-ingredient-order-spek" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-ingredient-order-cibule">Cibule (kg)</label>
                    <input type="number" id="spizy-ingredient-order-cibule" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-ingredient-order-paprika">Paprika (kg)</label>
                    <input type="number" id="spizy-ingredient-order-paprika" min="0">
                </div>
            </div>
             <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-spizy-ingredient-order-btn" data-action="save-spizy-ingredient-order">Uložit objednávku</button>
            </div>
        </div>
    </div>

    <div id="spizy-add-order-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
             <div class="modal-header">
                <h2 class="modal-title" id="spizy-add-order-modal-title">Přidat objednávku špízů</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="spizy-order-customer">Zákazník</label>
                    <select id="spizy-order-customer"></select>
                </div>
                <div class="form-group">
                    <label for="spizy-order-klobasa">Špíz Klobása (beden)</label>
                    <input type="number" id="spizy-order-klobasa" min="0">
                </div>
                 <div class="form-group">
                    <label for="spizy-order-spek">Špíz Špek (beden)</label>
                    <input type="number" id="spizy-order-spek" min="0">
                </div>
                 <div class="form-group">
                    <label for="spizy-order-cilli">Špíz Čilli Mango (beden)</label>
                    <input type="number" id="spizy-order-cilli" min="0">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-spizy-order-btn" data-action="save-spizy-order">Uložit</button>
            </div>
        </div>
    </div>
    
    <div id="spizy-stock-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
             <div class="modal-header">
                <h2 class="modal-title">Sklad surovin pro špízy</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="spizy-stock-klobasa">Klobása (kg)</label>
                    <input type="number" id="spizy-stock-klobasa" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-stock-spek">Špek (kg)</label>
                    <input type="number" id="spizy-stock-spek" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-stock-steak">Steak (kg)</label>
                    <input type="number" id="spizy-stock-steak" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-stock-cibule">Cibule (kg)</label>
                    <input type="number" id="spizy-stock-cibule" min="0">
                </div>
                <div class="form-group">
                    <label for="spizy-stock-paprika">Paprika (kg) - *zatím nevyužito*</label>
                    <input type="number" id="spizy-stock-paprika" min="0">
                </div>
            </div>
             <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-spizy-stock-btn" data-action="save-spizy-stock">Uložit</button>
            </div>
        </div>
    </div>

    <div id="spizy-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Plán Špízů na <span id="spizy-modal-date"></span></h2>
                <div style="display: flex; align-items: center; gap: 12px;">
                     <button class="btn btn-secondary" data-action="open-spizy-stock-modal"><i data-feather="archive"></i>Sklad</button>
                     <button class="btn btn-secondary" data-action="open-spizy-ingredient-order-modal"><i data-feather="truck"></i>Objednat surovinu</button>
                     <button class="btn btn-primary" data-action="open-spizy-add-order-modal"><i data-feather="plus"></i>Přidat objednávku</button>
                     <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
                </div>
            </div>
            <div class="modal-body" id="spizy-modal-body">
                <!-- Content generated by JS -->
            </div>
        </div>
    </div>


    <div id="rizky-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Kalkulace Řízků</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <h4>Vstupní údaje (Objednávka na <span id="rizky-date"></span>)</h4>
                <p><strong>Potřeba řízků z objednávek:</strong> <span id="rizky-total-orders">...</span> kg</p>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <h4>Manuální vstupy & Nastavení</h4>
                <div class="form-row">
                    <div class="form-field">
                        <label for="rizky-stock">Skladem (kg)</label>
                        <input type="number" id="rizky-stock">
                    </div>
                    <div class="form-field">
                        <label for="rizky-prepad">Přepad (kg)</label>
                        <input type="number" id="rizky-prepad">
                    </div>
                     <div class="form-field">
                        <label for="rizky-mastna">Mastná (kg)</label>
                        <input type="number" id="rizky-mastna">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-field">
                        <label for="rizky-line-performance">Výkon linky (kg/hod)</label>
                        <input type="number" id="rizky-line-performance">
                    </div>
                     <div class="form-field">
                        <label for="rizky-start-time">Start linky (čas)</label>
                        <input type="time" id="rizky-start-time">
                    </div>
                </div>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <h4>Výsledky kalkulace</h4>
                <p><strong>Celková potřeba výroby:</strong> <span id="rizky-total-needed" style="font-weight: bold; font-size: 1.1em;">...</span> kg</p>
                <p><strong>Potřebný čas linky:</strong> <span id="rizky-runtime">...</span></p>
                <p><strong>Předpokládaný konec výroby:</strong> <span id="rizky-end-time" style="font-weight: bold; color: var(--accent-primary);">...</span></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" data-action="close-modal">Zavřít</button>
            </div>
        </div>
    </div>

    <div id="kfc-stock-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Sklad KFC Surovin</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <table class="data-table" id="kfc-stock-table">
                    <thead><tr><th>Surovina</th><th>Skladem (beden)</th><th>Váha bedny (g)</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-kfc-stock-btn" data-action="save-kfc-stock">Uložit</button>
            </div>
        </div>
    </div>
    
    <div id="kfc-add-order-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Přidat KFC Objednávku na den <span id="kfc-order-date"></span></h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                 <table class="data-table" id="kfc-add-order-table">
                    <thead><tr><th>Produkt</th><th>Dnes (beden)</th><th>Zítra (beden)</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-kfc-order-btn" data-action="save-kfc-order">Uložit objednávku</button>
            </div>
        </div>
    </div>
    
    <div id="kfc-staff-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Kalkulace pracovní síly (KFC)</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <p><strong>Celkový čas výroby (1 osoba):</strong> <span id="kfc-staff-total-time"></span></p>
                <p><strong>Potřeba lidí (pro dokončení do 24:00):</strong> <span id="kfc-staff-needed" style="font-weight: bold; font-size: 1.1em;">...</span></p>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <div class="form-group">
                    <label for="kfc-staff-added">Přidat zaměstnanců (k 1 základu)</label>
                    <input type="number" id="kfc-staff-added" min="0">
                </div>
                <h4>Výsledky</h4>
                <p><strong>Nový čas dokončení:</strong> <span id="kfc-new-completion-time" style="font-weight: bold; color: var(--accent-primary);">...</span></p>

            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-kfc-staff-btn" data-action="save-kfc-staff">Uložit</button>
            </div>
        </div>
    </div>


    <div id="maykawa-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Maykawa Kalkulace Steaku</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <h4>Vstupní údaje (Objednávka na <span id="maykawa-date"></span>)</h4>
                <p><strong>Potřeba steaku celkem:</strong> <span id="maykawa-steak-needed">...</span> kg</p>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <h4>Nastavení výtěžnosti a výkonu (ze stehen)</h4>
                <div class="form-row">
                    <div class="form-field">
                        <label for="maykawa-bone-percent">Ztráta kostí (%)</label>
                        <input type="number" id="maykawa-bone-percent" min="0" max="100">
                    </div>
                    <div class="form-field">
                        <label for="maykawa-skin-percent">Ztráta kůže (%)</label>
                        <input type="number" id="maykawa-skin-percent" min="0" max="100">
                    </div>
                    <div class="form-field">
                        <label>Výtěžnost steaku (%)</label>
                        <input type="number" id="maykawa-yield-percent" readonly style="background-color: var(--bg-tertiary);">
                    </div>
                </div>
                 <div class="form-row">
                    <div class="form-field">
                        <label for="maykawa-deboning-speed">Rychlost koštění (kg/hod)</label>
                        <input type="number" id="maykawa-deboning-speed" min="0">
                    </div>
                </div>
                 <p id="maykawa-total-percent-warning" style="color: var(--accent-danger); font-weight: bold; display: none;">Součet procent musí být 100%.</p>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <h4>Výsledky kalkulace</h4>
                <p><strong>Potřeba stehen celkem:</strong> <span id="maykawa-thighs-needed-kg" style="font-weight: bold; font-size: 1.1em;">...</span> kg</p>
                <p><strong>Potřebný čas na vykostění:</strong> <span id="maykawa-needed-time" style="font-weight: bold; color: var(--accent-primary);">...</span></p>
                <p><strong>Potřeba stehen (palety):</strong> <span id="maykawa-thighs-needed-pallets">...</span></p>
                <p><strong>Vyprodukováno kostí:</strong> <span id="maykawa-bones-produced">...</span> kg</p>
                <p><strong>Vyprodukováno kůže:</strong> <span id="maykawa-skin-produced">...</span> kg</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" data-action="close-modal">Zavřít</button>
            </div>
        </div>
    </div>

    <div id="add-main-order-modal" class="modal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 class="modal-title">Přidat rychlou objednávku</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="main-order-customer">Zákazník</label>
                    <select id="main-order-customer"></select>
                </div>
                <div class="form-group" id="main-order-type-group" style="display: none;">
                    <label for="main-order-type">Typ balení</label>
                    <select id="main-order-type">
                        <option value="">-- Vyberte --</option>
                        <option value="OA">Malé misky (OA)</option>
                        <option value="RB">Rodinné balení (RB)</option>
                        <option value="VL">Volně ložené (VL)</option>
                    </select>
                </div>
                <div id="main-order-products-container">
                    <p>Nejprve vyberte zákazníka a typ balení.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-main-order-btn" data-action="save-main-order">Uložit objednávku</button>
            </div>
        </div>
    </div>

    <div id="add-change-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="add-change-modal-title">Přidat změnu</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-field">
                        <label for="change-date-from">Platnost od</label>
                        <input type="date" id="change-date-from">
                    </div>
                    <div class="form-field">
                        <label for="change-date-to">Platnost do (nepovinné)</label>
                        <input type="date" id="change-date-to">
                    </div>
                </div>
                <div class="form-group">
                    <label for="change-title">Nadpis</label>
                    <input type="text" id="change-title" placeholder="Stručný popis změny">
                </div>
                <div class="form-group">
                    <label for="change-text">Text změny</label>
                    <textarea id="change-text" placeholder="Detailní popis změny..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-change-btn" data-action="save-change">Uložit změnu</button>
            </div>
        </div>
    </div>
    
    <div id="mix-ratio-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="mix-ratio-modal-title">Upravit poměr surovin</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body" id="mix-ratio-modal-body"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-mix-ratio-btn" data-action="save-mix-ratio">Uložit poměr</button>
            </div>
        </div>
    </div>

    <div id="add-order-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="add-order-modal-title">Přidat položky do objednávky</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body" id="add-order-modal-body"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-added-items-btn" data-action="save-added-items">Přidat do objednávky</button>
            </div>
        </div>
    </div>

    <div id="plan-action-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="plan-action-modal-title">Naplánovat akci</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-field"><label>Zákazník</label><select id="plan-action-customer"></select></div>
                    <div class="form-field"><label>Produkt</label><select id="plan-action-product"></select></div>
                </div>
                <div class="form-row">
                    <div class="form-field"><label>Od</label><input type="date" id="plan-action-from"></div>
                    <div class="form-field"><label>Do</label><input type="date" id="plan-action-to"></div>
                </div>
                <div id="plan-action-daily-counts"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-planned-action-btn" data-action="save-planned-action">Uložit akci</button>
            </div>
        </div>
    </div>
    
    <div id="day-details-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="day-details-title">Detail dne</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body" id="day-details-body"></div>
        </div>
    </div>

    <div id="calculator-add-item-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="calculator-add-item-modal-title">Přidat položku do kalkulace</h2>
                <button class="btn-icon" data-action="close-modal"><i data-feather="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-field">
                        <label for="calculator-item-surovina">Surovina</label>
                        <select id="calculator-item-surovina"></select>
                    </div>
                    <div class="form-field">
                        <label for="calculator-item-type">Typ balení</label>
                        <select id="calculator-item-type">
                             <option value="">-- Vyberte --</option>
                             <option value="OA">Malé misky (OA)</option>
                             <option value="RB">Rodinné balení (RB)</option>
                             <option value="VL">Volně ložené (VL)</option>
                        </select>
                    </div>
                </div>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 20px 0;">
                <div id="calculator-customer-inputs">
                    <p>Nejprve vyberte surovinu a typ balení.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-action="close-modal">Zrušit</button>
                <button class="btn btn-primary" id="save-calculator-item-btn" data-action="save-calculator-item">Uložit položku</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title" id="confirmation-modal-title">Potvrdit akci</h2>
            </div>
            <div class="modal-body" id="confirmation-modal-body">
                <p>Opravdu si přejete pokračovat?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="confirmation-cancel-btn">Zrušit</button>
                <button class="btn btn-danger" id="confirmation-confirm-btn">Potvrdit</button>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>
    
    <script type="module" src="index.tsx"></script>

</body>
</html>